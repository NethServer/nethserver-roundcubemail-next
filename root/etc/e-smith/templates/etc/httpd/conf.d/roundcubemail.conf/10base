#
# Round Cube Webmail is a browser-based multilingual IMAP client
# 

Alias /roundcubemail /usr/share/roundcubemail
Alias /webmail /usr/share/roundcubemail

RewriteEngine On
RewriteRule ^/webmail(/.*)?\$ https://%{HTTP_HOST}/webmail\$1 [R=301,L]
RewriteRule ^/roundcubemail(/.*)?\$ https://%{HTTP_HOST}/roundcubemail\$1 [R=301,L]


<Directory /usr/share/roundcubemail/>
    <IfModule mod_authz_core.c>
        # Apache 2.4
        Require {$OUT .= ( $roundcubemail{access} eq "public" ) ? "all granted" : "ip $localAccess" ;}
    </IfModule>
    <IfModule !mod_authz_core.c>
        # Apache 2.2
        Order Deny,Allow
        Deny from all
        Allow from {$OUT .= ( $roundcubemail{access} eq "public" ) ? "all" : $localAccess ;}
    </IfModule>
</Directory>

# Define who can access the installer
# keep this secured once configured

<Directory /usr/share/roundcubemail/installer/>
    <IfModule mod_authz_core.c>
        # Apache 2.4
        Require local
    </IfModule>
    <IfModule !mod_authz_core.c>
        # Apache 2.2
        Order Deny,Allow
        Deny from all
        Allow from 127.0.0.1
        Allow from ::1
    </IfModule>
</Directory>

# Those directories should not be viewed by Web clients.
<Directory /usr/share/roundcubemail/bin/>
    Order Allow,Deny
    Deny from all
</Directory>
<Directory /usr/share/roundcubemail/plugins/enigma/home/>
    Order Allow,Deny
    Deny from all
</Directory>

